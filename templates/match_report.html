{% extends "base.html" %}

{% block title %}Report Match{% endblock %}

{% block content %}
<section class="card">
    <div class="card-header">
        <div>
            <h2 class="card-title">Report Match Result</h2>
            <p class="card-subtitle">{{ match.player1_name }} vs {{ match.player2_name }}</p>
        </div>
        {% if match.reported %}
            <span class="chip chip-success">Already Reported</span>
        {% endif %}
    </div>
    <p class="card-meta">Enter up to three games (best two of three). Leave Game 3 blank if the match ends in two games.</p>
    <form method="post" class="form-grid">
        <div class="table-wrapper">
            <table class="table">
                <thead>
                    <tr>
                        <th>Game</th>
                        <th>{{ match.player1_name }}</th>
                        <th>{{ match.player2_name }}</th>
                    </tr>
                </thead>
                <tbody>
                    {% for idx in range(1, max_games + 1) %}
                    {% set existing = game_scores[idx-1] if game_scores and game_scores|length >= idx else (None, None) %}
                    <tr>
                        <td>Game {{ idx }}</td>
                        <td>
                            <input type="number" name="game{{ idx }}_score1" min="0" value="{{ existing[0] if existing[0] is not none else '' }}">
                        </td>
                        <td>
                            <input type="number" name="game{{ idx }}_score2" min="0" value="{{ existing[1] if existing[1] is not none else '' }}">
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        <div class="form-note" style="margin-top: 0.5rem; padding: 0.75rem; background: rgba(0, 188, 235, 0.08); border-radius: var(--radius-sm); border-left: 3px solid var(--cisco-cyan);">
            ðŸ’¡ <strong>Note:</strong> Scores can be edited during the current week if needed. Make sure both players agree on the final result.
        </div>
        <button class="btn btn-primary" type="submit">{{ 'Update Score' if match.reported else 'Submit Result' }}</button>
    </form>
</section>
{% endblock %}
